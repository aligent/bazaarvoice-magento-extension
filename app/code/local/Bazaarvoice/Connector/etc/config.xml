<?xml version="1.0"?>
<!--
/**
* @category   BV
* @package    Bazaarvoice
*/
-->
<config>
    <modules>
        <Bazaarvoice_Connector>
            <version>6.0.0</version>
            <depends>
                <!-- no dependencies -->
            </depends>
        </Bazaarvoice_Connector>
    </modules>

    <global>
        <models>
            <bazaarvoice>
                <class>Bazaarvoice_Connector_Model</class>
            </bazaarvoice>
        </models>
        <blocks>
            <bazaarvoice>
                <class>Bazaarvoice_Connector_Block</class>
            </bazaarvoice>
        </blocks>
        <helpers>
            <bazaarvoice>
                <class>Bazaarvoice_Connector_Helper</class>
            </bazaarvoice>
        </helpers>
        <template>
            <email>
                <bazaarvoice_notification_template module="bazaarvoice">
                    <label>Bazaarvoice Notifications</label>
                    <file>bazaarvoice_notification.html</file>
                    <type>text</type>
                </bazaarvoice_notification_template>
            </email>
        </template>
        <resources>
            <bazaarvoice_setup>
                <setup>
                    <module>Bazaarvoice_Connector</module>
                    <class>Bazaarvoice_Connector_Model_Mysql4_Setup</class>
                </setup>
                <connection>
                    <use>core_setup</use>
                </connection>
            </bazaarvoice_setup>
        </resources>
    </global>

    <frontend>
        <product>
            <collection>
                <attributes>
                    <bv_average_rating />
                    <bv_review_count />
                    <bv_rating_range />
                </attributes>
            </collection>
        </product>
        <routers>
            <bazaarvoice>
                <use>standard</use>
                <args>
                    <module>Bazaarvoice_Connector</module>
                    <frontName>bazaarvoice</frontName>
                </args>
            </bazaarvoice>
        </routers>
        <layout>
            <updates>
                <bazaarvoice>
                    <file>bazaarvoice.xml</file>
                </bazaarvoice>
            </updates>
        </layout>
    </frontend>

    <crontab>
        <jobs>
            <bazaarvoice_product_feed>
                <schedule>
                    <cron_expr>0 1 * * *</cron_expr><!-- Every day at 1:00 AM -->
                </schedule>
                <run>
                    <model>bazaarvoice/exportProductFeed::exportDailyProductFeed</model>
                </run>
            </bazaarvoice_product_feed>
<!--  Temp disable as part of MGP-103         
            <bazaarvoice_download_inlineratings>
                <schedule>
                    <cron_expr>30 1 * * *</cron_expr>  Every day at 1:30 AM
                </schedule>
                <run>
                    <model>bazaarvoice/retrieveInlineRatingsFeed::retrieveInlineRatingsFeed</model>
                </run>
            </bazaarvoice_download_inlineratings>
-->
            <bazaarvoice_download_smartseo>
                <schedule>
                    <cron_expr>0 2 * * *</cron_expr><!-- Every day at 2 AM -->
                </schedule>
                <run>
                    <model>bazaarvoice/retrieveSmartSEOPackage::retrieveSmartSEOPackage</model>
                </run>
            </bazaarvoice_download_smartseo>
            <bazaarvoice_purchase_feed>
                <schedule>
                    <cron_expr>30 2 * * 6</cron_expr><!-- Every Saturday at 2:30 AM -->
                </schedule>
                <run>
                    <model>bazaarvoice/exportPurchaseFeed::exportPurchaseFeed</model>
                </run>
            </bazaarvoice_purchase_feed>
        </jobs>
    </crontab>

    <default>
        <bazaarvoice>
            <General>
                <environment>staging</environment>
                <SubmissionDisplayTypeJavascript><![CDATA[
                    var userAgent = navigator.userAgent.toLowerCase();
                    var isMobileDevice = (userAgent.search("iphone") > -1 || userAgent.search("android") > -1 || userAgent.search("blackberry") > -1);
                    return (isMobileDevice ? "mobile" : "");
                ]]></SubmissionDisplayTypeJavascript>
            </General>
            <RR>
                <EnableRR>1</EnableRR>
                <SubDomain>reviews</SubDomain>
                <DisplayCodeJavascript><![CDATA[
                    // no-op
                ]]></DisplayCodeJavascript>
                <OnEventJavascript><![CDATA[
                    if (json.eventSource == "Display") {
                    if (json.attributes.numReviews == 0) {
                    var bvRevCntr = document.getElementById("BVReviewsContainer");
                    var bvSVPLink = document.getElementById("BVRRLinkContainer");

                    if (bvRevCntr) { bvRevCntr.style.display = "none"; }
                    if (bvSVPLink) { bvSVPLink.style.display = "none"; }
                    }
                    }
                ]]></OnEventJavascript>
                <DisplayTypeJavascript><![CDATA[
                    var userAgent = navigator.userAgent.toLowerCase();
                    var isMobileDevice = (userAgent.search("iphone") > -1 || userAgent.search("android") > -1 || userAgent.search("blackberry") > -1);
                    return (isMobileDevice ? "mobile" : "");
                ]]></DisplayTypeJavascript>
                <DoShowContentJavascript><![CDATA[
                    // code to execute when read reviews link is clicked
                ]]></DoShowContentJavascript>
            </RR>
            <AA>
                <SubDomain>answers</SubDomain>
                <DisplayCodeJavascript><![CDATA[
                    // no-op
                ]]></DisplayCodeJavascript>
                <OnEventJavascript><![CDATA[
                    if (json.eventSource == "Display") {
                    if (json.attributes.numQuestions == 0) {
                    var bvQACntr = document.getElementById("BVQAContainer");

                    if (bvQACntr) { bvQACntr.style.display = "none"; }
                    }
                    }
                ]]></OnEventJavascript>
                <DoShowContentJavascript><![CDATA[
                    // code to execute when read answers link is clicked
                ]]></DoShowContentJavascript>
            </AA>
            <CP>
                <SubDomain>ugc</SubDomain>
                <DisplayCodeJavascript><![CDATA[
                    // no-op
                ]]></DisplayCodeJavascript>
                <OnEventJavascript><![CDATA[
                    // no-op
                ]]></OnEventJavascript>
            </CP>
            <ProductFeed>
                <EnableProductFeed>1</EnableProductFeed>
            </ProductFeed>
<!--  Temp disable as part of MGP-103         
            <InlineRatingFeed>
                <EnableInlineRatings>1</EnableInlineRatings>
                <FeedFileName>bv_(clientname)_ratings.xml.gz</FeedFileName>
            </InlineRatingFeed>
-->            
            <SmartSEOFeed>
                <EnableSmartSEO>1</EnableSmartSEO>
                <FeedFileName>bv_(clientname)_smartseo.tar.gz</FeedFileName>
            </SmartSEOFeed>
            <PurchaseFeed>
                <EnablePurchaseFeed>1</EnablePurchaseFeed>
                <TriggeringEvent>shipping</TriggeringEvent>
            </PurchaseFeed>
        </bazaarvoice>
    </default>

</config>
